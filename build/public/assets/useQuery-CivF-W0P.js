var ut=e=>{throw TypeError(e)};var G=(e,t,s)=>t.has(e)||ut("Cannot "+s);var r=(e,t,s)=>(G(e,t,"read from private field"),s?s.call(e):t.get(e)),p=(e,t,s)=>t.has(e)?ut("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),h=(e,t,s,i)=>(G(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),d=(e,t,s)=>(G(e,t,"access private method"),s);import{aa as Ot,ab as lt,ac as w,ad as J,ae as W,af as wt,ag as X,ah as dt,ai as St,aj as Et,ak as It,al as ft,am as vt,d as S,u as Qt}from"./app-CsfJiPAg.js";import{s as xt,n as pt}from"./utils-DTxDwtwe.js";var m,a,z,g,x,M,E,O,N,P,_,T,F,I,k,n,H,Y,Z,tt,et,st,rt,it,Rt,mt,Tt=(mt=class extends Ot{constructor(t,s){super();p(this,n);p(this,m);p(this,a);p(this,z);p(this,g);p(this,x);p(this,M);p(this,E);p(this,O);p(this,N);p(this,P);p(this,_);p(this,T);p(this,F);p(this,I);p(this,k,new Set);this.options=s,h(this,m,t),h(this,O,null),h(this,E,lt()),this.options.experimental_prefetchInRender||r(this,E).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,a).addObserver(this),yt(r(this,a),this.options)?d(this,n,H).call(this):this.updateResult(),d(this,n,et).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return at(r(this,a),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return at(r(this,a),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,d(this,n,st).call(this),d(this,n,rt).call(this),r(this,a).removeObserver(this)}setOptions(t){const s=this.options,i=r(this,a);if(this.options=r(this,m).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof w(this.options.enabled,r(this,a))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");d(this,n,it).call(this),r(this,a).setOptions(this.options),s._defaulted&&!J(this.options,s)&&r(this,m).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,a),observer:this});const l=this.hasListeners();l&&bt(r(this,a),i,this.options,s)&&d(this,n,H).call(this),this.updateResult(),l&&(r(this,a)!==i||w(this.options.enabled,r(this,a))!==w(s.enabled,r(this,a))||W(this.options.staleTime,r(this,a))!==W(s.staleTime,r(this,a)))&&d(this,n,Y).call(this);const c=d(this,n,Z).call(this);l&&(r(this,a)!==i||w(this.options.enabled,r(this,a))!==w(s.enabled,r(this,a))||c!==r(this,I))&&d(this,n,tt).call(this,c)}getOptimisticResult(t){const s=r(this,m).getQueryCache().build(r(this,m),t),i=this.createResult(s,t);return Ut(this,i)&&(h(this,g,i),h(this,M,this.options),h(this,x,r(this,a).state)),i}getCurrentResult(){return r(this,g)}trackResult(t,s){const i={};return Object.keys(t).forEach(l=>{Object.defineProperty(i,l,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(l),s==null||s(l),t[l])})}),i}trackProp(t){r(this,k).add(t)}getCurrentQuery(){return r(this,a)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=r(this,m).defaultQueryOptions(t),i=r(this,m).getQueryCache().build(r(this,m),s);return i.fetch().then(()=>this.createResult(i,s))}fetch(t){return d(this,n,H).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,g)))}createResult(t,s){var ct;const i=r(this,a),l=this.options,c=r(this,g),o=r(this,x),Q=r(this,M),R=t!==i?t.state:r(this,z),{state:j}=t;let u={...j},L=!1,y;if(s._optimisticResults){const b=this.hasListeners(),U=!b&&yt(t,s),D=b&&bt(t,i,s,l);(U||D)&&(u={...u,...It(j.data,t.options)}),s._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:q,errorUpdatedAt:A,status:v}=u;if(s.select&&u.data!==void 0)if(c&&u.data===(o==null?void 0:o.data)&&s.select===r(this,N))y=r(this,P);else try{h(this,N,s.select),y=s.select(u.data),y=ft(c==null?void 0:c.data,y,s),h(this,P,y),h(this,O,null)}catch(b){h(this,O,b)}else y=u.data;if(s.placeholderData!==void 0&&y===void 0&&v==="pending"){let b;if(c!=null&&c.isPlaceholderData&&s.placeholderData===(Q==null?void 0:Q.placeholderData))b=c.data;else if(b=typeof s.placeholderData=="function"?s.placeholderData((ct=r(this,_))==null?void 0:ct.state.data,r(this,_)):s.placeholderData,s.select&&b!==void 0)try{b=s.select(b),h(this,O,null)}catch(U){h(this,O,U)}b!==void 0&&(v="success",y=ft(c==null?void 0:c.data,b,s),L=!0)}r(this,O)&&(q=r(this,O),y=r(this,P),A=Date.now(),v="error");const B=u.fetchStatus==="fetching",$=v==="pending",K=v==="error",ot=$&&B,ht=y!==void 0,C={status:v,fetchStatus:u.fetchStatus,isPending:$,isSuccess:v==="success",isError:K,isInitialLoading:ot,isLoading:ot,data:y,dataUpdatedAt:u.dataUpdatedAt,error:q,errorUpdatedAt:A,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>R.dataUpdateCount||u.errorUpdateCount>R.errorUpdateCount,isFetching:B,isRefetching:B&&!$,isLoadingError:K&&!ht,isPaused:u.fetchStatus==="paused",isPlaceholderData:L,isRefetchError:K&&ht,isStale:nt(t,s),refetch:this.refetch,promise:r(this,E)};if(this.options.experimental_prefetchInRender){const b=V=>{C.status==="error"?V.reject(C.error):C.data!==void 0&&V.resolve(C.data)},U=()=>{const V=h(this,E,C.promise=lt());b(V)},D=r(this,E);switch(D.status){case"pending":t.queryHash===i.queryHash&&b(D);break;case"fulfilled":(C.status==="error"||C.data!==D.value)&&U();break;case"rejected":(C.status!=="error"||C.error!==D.reason)&&U();break}}return C}updateResult(){const t=r(this,g),s=this.createResult(r(this,a),this.options);if(h(this,x,r(this,a).state),h(this,M,this.options),r(this,x).data!==void 0&&h(this,_,r(this,a)),J(s,t))return;h(this,g,s);const i=()=>{if(!t)return!0;const{notifyOnChangeProps:l}=this.options,c=typeof l=="function"?l():l;if(c==="all"||!c&&!r(this,k).size)return!0;const o=new Set(c??r(this,k));return this.options.throwOnError&&o.add("error"),Object.keys(r(this,g)).some(Q=>{const f=Q;return r(this,g)[f]!==t[f]&&o.has(f)})};d(this,n,Rt).call(this,{listeners:i()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&d(this,n,et).call(this)}},m=new WeakMap,a=new WeakMap,z=new WeakMap,g=new WeakMap,x=new WeakMap,M=new WeakMap,E=new WeakMap,O=new WeakMap,N=new WeakMap,P=new WeakMap,_=new WeakMap,T=new WeakMap,F=new WeakMap,I=new WeakMap,k=new WeakMap,n=new WeakSet,H=function(t){d(this,n,it).call(this);let s=r(this,a).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(wt)),s},Y=function(){d(this,n,st).call(this);const t=W(this.options.staleTime,r(this,a));if(X||r(this,g).isStale||!dt(t))return;const i=St(r(this,g).dataUpdatedAt,t)+1;h(this,T,setTimeout(()=>{r(this,g).isStale||this.updateResult()},i))},Z=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,a)):this.options.refetchInterval)??!1},tt=function(t){d(this,n,rt).call(this),h(this,I,t),!(X||w(this.options.enabled,r(this,a))===!1||!dt(r(this,I))||r(this,I)===0)&&h(this,F,setInterval(()=>{(this.options.refetchIntervalInBackground||Et.isFocused())&&d(this,n,H).call(this)},r(this,I)))},et=function(){d(this,n,Y).call(this),d(this,n,tt).call(this,d(this,n,Z).call(this))},st=function(){r(this,T)&&(clearTimeout(r(this,T)),h(this,T,void 0))},rt=function(){r(this,F)&&(clearInterval(r(this,F)),h(this,F,void 0))},it=function(){const t=r(this,m).getQueryCache().build(r(this,m),this.options);if(t===r(this,a))return;const s=r(this,a);h(this,a,t),h(this,z,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},Rt=function(t){vt.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(r(this,g))}),r(this,m).getQueryCache().notify({query:r(this,a),type:"observerResultsUpdated"})})},mt);function Ft(e,t){return w(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function yt(e,t){return Ft(e,t)||e.state.data!==void 0&&at(e,t,t.refetchOnMount)}function at(e,t,s){if(w(t.enabled,e)!==!1){const i=typeof s=="function"?s(e):s;return i==="always"||i!==!1&&nt(e,t)}return!1}function bt(e,t,s,i){return(e!==t||w(i.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&nt(e,s)}function nt(e,t){return w(t.enabled,e)!==!1&&e.isStaleByTime(W(t.staleTime,e))}function Ut(e,t){return!J(e.getCurrentResult(),t)}var Ct=S.createContext(!1),Dt=()=>S.useContext(Ct);Ct.Provider;function Mt(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Pt=S.createContext(Mt()),_t=()=>S.useContext(Pt),kt=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},jt=e=>{S.useEffect(()=>{e.clearReset()},[e])},Lt=({result:e,errorResetBoundary:t,throwOnError:s,query:i,suspense:l})=>e.isError&&!t.isReset()&&!e.isFetching&&i&&(l&&e.data===void 0||xt(s,[e.error,i])),qt=e=>{const t=e.staleTime;e.suspense&&(e.staleTime=typeof t=="function"?(...s)=>Math.max(t(...s),1e3):Math.max(t??1e3,1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},At=(e,t)=>e.isLoading&&e.isFetching&&!t,Bt=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,gt=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function Ht(e,t,s){var u,L,y,q,A;if(typeof e!="object"||Array.isArray(e))throw new Error('Bad argument type. Starting with v5, only the "Object" form is allowed when calling query related functions. Please use the error stack to find the culprit call. More info here: https://tanstack.com/query/latest/docs/react/guides/migrating-to-v5#supports-a-single-signature-one-object');const i=Qt(),l=Dt(),c=_t(),o=i.defaultQueryOptions(e);(L=(u=i.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||L.call(u,o),o.queryFn||console.error(`[${o.queryHash}]: No queryFn was passed as an option, and no default queryFn was found. The queryFn parameter is only optional when using a default queryFn. More info here: https://tanstack.com/query/latest/docs/framework/react/guides/default-query-function`),o._optimisticResults=l?"isRestoring":"optimistic",qt(o),kt(o,c),jt(c);const Q=!i.getQueryCache().get(o.queryHash),[f]=S.useState(()=>new t(i,o)),R=f.getOptimisticResult(o),j=!l&&e.subscribed!==!1;if(S.useSyncExternalStore(S.useCallback(v=>{const B=j?f.subscribe(vt.batchCalls(v)):pt;return f.updateResult(),B},[f,j]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),S.useEffect(()=>{f.setOptions(o)},[o,f]),Bt(o,R))throw gt(o,f,c);if(Lt({result:R,errorResetBoundary:c,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw R.error;if((q=(y=i.getDefaultOptions().queries)==null?void 0:y._experimental_afterQuery)==null||q.call(y,o,R),o.experimental_prefetchInRender&&!X&&At(R,l)){const v=Q?gt(o,f,c):(A=i.getQueryCache().get(o.queryHash))==null?void 0:A.promise;v==null||v.catch(pt).finally(()=>{f.updateResult()})}return o.notifyOnChangeProps?R:f.trackResult(R)}function $t(e,t){return Ht(e,Tt)}export{$t as u};
