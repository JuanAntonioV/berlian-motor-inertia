import{q as w,u as q,d as f,j as e,a as F,B as b,U as L,r as $,D as z,V as Q,f as K}from"./app-DRChOLyS.js";import{u as N}from"./useQuery-PpjB-SNB.js";import{u as Y,A as U,f as H}from"./utils-BzyQMKcG.js";import{l as P,u as J,A as O}from"./AdminLayout-CgYzeF35.js";import{c as _}from"./goods_receipt_api-DuI0Nt5l.js";import{g as W}from"./product_api-CnJOPHxD.js";import{g as X}from"./storage_api-D7uWK4W4.js";import{S as Z}from"./StorageModal-DOj8t8V1.js";import{S as D}from"./SectionHeader-DMTrun-R.js";import{P as ee}from"./PageTitle-DimwbdIk.js";import{P as ie}from"./PageTransition-Ca3SZbiI.js";import{u as re,I as oe,z as te,g as ae}from"./validators-DVmJ9Wut.js";import{F as ne}from"./Form-CoY4bDSt.js";import{S as d,C as R,a as se,b as le}from"./Title-DVbCuHvN.js";import{A as me,T as c}from"./TextInput-qBzfsNLo.js";import{S as de}from"./SimpleGrid-CR4JtHv5.js";import{D as ce}from"./DatePickerInput-1gvd8nWV.js";import{S as x}from"./Select-C7ktlXYe.js";import{F as ue,T as pe}from"./trash-DlOVcsjn.js";import{T as ge}from"./Textarea-BICgDL0R.js";import{T as o}from"./Table-DvmPKRof.js";import{N as j}from"./NumberInput-DshG0eT7.js";import{P as fe}from"./plus-B8lXpxzg.js";import"./Form-Be3on0Th.js";import"./Image-DqzSiCpC.js";import"./FileButton-CaOil0d6.js";import"./pick-calendar-levels-props-BuM-Az3U.js";import"./CheckIcon-DubuhHZI.js";import"./react-number-format.es-D6rMK7tG.js";const be=()=>{var u,p;const{generatedId:s}=w().props,{data:n,isPending:h,isError:C}=N({queryKey:["storages"],queryFn:X,select:r=>r.data}),{data:l,isPending:M,isError:E}=N({queryKey:["products"],queryFn:()=>W(),select:r=>r.data}),i=re({mode:"uncontrolled",validate:te(ae),initialValues:{id:s,storageId:0,reference:"",supplierName:"",receivedAt:new Date,attachment:null,notes:"",items:[{id:-1,quantity:"",price:""}]}}),m=q(),{mutate:B,isPending:v,error:a}=Y({mutationFn:_,onSuccess:()=>{m.refetchQueries({queryKey:["goodsReceipts"]}),m.refetchQueries({queryKey:["products"]}),m.refetchQueries({queryKey:["goodsReceiptStats"]}),Q.success("Berhasil menyimpan transaksi!"),K.visit("/penerimaan-barang")},onError:r=>{i.setErrors(H(r.errors))}}),V=r=>{B({...r,receivedAt:z.fromJSDate(new Date(r.receivedAt)).toISODate({format:"extended"})})},G=f.useMemo(()=>P.isEmpty(n)?[]:n==null?void 0:n.map(r=>({label:r.name,value:r.id.toString()})),[n]),[k,{open:y,close:T}]=J(),S=f.useMemo(()=>P.isEmpty(l)?[]:l.map(r=>({label:`${r.name} - ${r.sku}`,value:r.id.toString()})),[l]),I=({options:r})=>r.filter(t=>{var g;return!((g=i.getValues())!=null&&g.items.some(A=>String(A.id)===String(t.value)))});return e.jsxDEV(e.Fragment,{children:[e.jsxDEV(F,{title:"Penerimaan Barang"},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:129,columnNumber:7},void 0),e.jsxDEV(Z,{opened:k,onClose:T,onCreatedId:r=>{r&&i.getInputProps("storageId").onChange({value:[r.toString()]})}},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:131,columnNumber:7},void 0),e.jsxDEV(ie,{children:e.jsxDEV(ne,{form:i,onSubmit:V,children:[e.jsxDEV(ee,{title:"Tambah Penerimaan Barang",description:"Merupakan halaman untuk menambah penerimaan barang baru ke dalam sistem.",children:e.jsxDEV(b,{type:"submit",loading:v,children:"Simpan"},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:145,columnNumber:13},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:141,columnNumber:11},void 0),e.jsxDEV(d,{children:[e.jsxDEV(R,{shadow:"xs",children:[e.jsxDEV(D,{title:"Informasi Penerimaan"},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:151,columnNumber:15},void 0),(a==null?void 0:a.message)&&e.jsxDEV(me,{color:"red",c:"red",icon:e.jsxDEV(oe,{},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:154,columnNumber:52},void 0),mb:"md",children:a==null?void 0:a.message},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:154,columnNumber:17},void 0),e.jsxDEV(d,{children:[e.jsxDEV(de,{cols:{base:1,md:2,lg:3},spacing:"lg",children:[e.jsxDEV(c,{placeholder:"Masukkan nomor transaksi",label:"Nomor Transaksi",withAsterisk:!0,...i.getInputProps("id")},i.key("id"),!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:161,columnNumber:19},void 0),e.jsxDEV(ce,{placeholder:"Pilih tanggal penerimaan",label:"Tanggal Penerimaan",withAsterisk:!0,highlightToday:!0,valueFormat:"DD MMMM YYYY",...i.getInputProps("receivedAt")},i.key("receivedAt"),!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:168,columnNumber:19},void 0),e.jsxDEV(c,{placeholder:"Masukkan referensi",label:"Referensi",...i.getInputProps("reference")},i.key("reference"),!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:177,columnNumber:19},void 0)]},void 0,!0,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:160,columnNumber:17},void 0),e.jsxDEV(c,{placeholder:"Masukkan nama pemasok",label:"Nama Pemasok",withAsterisk:!0,autoFocus:!0,...i.getInputProps("supplierName")},i.key("supplierName"),!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:184,columnNumber:17},void 0),e.jsxDEV(x,{data:G,label:"Rak Penyimpanan Barang",placeholder:"Pilih rak penyimpanan barang",withAsterisk:!0,disabled:h||C,searchable:!0,descriptionProps:{component:"div"},description:e.jsxDEV(se,{c:"gray.6",fz:"xs",children:["Tidak menemukan rak?"," ",e.jsxDEV(L,{fz:"xs",c:"blue.5",onClick:y,children:"Tambah rak."},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:203,columnNumber:23},void 0)]},void 0,!0,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:201,columnNumber:21},void 0),clearable:!0,...i.getInputProps("storageId"),onChange:r=>{i.getInputProps("storageId").onChange(r)}},i.key("storageId"),!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:192,columnNumber:17},void 0),e.jsxDEV(ue,{accept:"image/*, application/pdf",placeholder:"Pilih file lampiran",label:"Upload Lampiran",clearable:!0,...i.getInputProps("attachment"),onChange:r=>{i.getInputProps("attachment").onChange(r)}},i.key("attachment"),!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:215,columnNumber:17},void 0),e.jsxDEV(ge,{placeholder:"Masukkan catatan tambahan",label:"Catatan",rows:3,...i.getInputProps("notes")},i.key("notes"),!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:226,columnNumber:17},void 0)]},void 0,!0,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:159,columnNumber:15},void 0)]},void 0,!0,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:150,columnNumber:13},void 0),e.jsxDEV(R,{shadow:"xs",children:[e.jsxDEV(D,{title:"List Barang"},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:236,columnNumber:15},void 0),e.jsxDEV(d,{children:e.jsxDEV(o,{striped:!0,children:[e.jsxDEV(o.Thead,{children:e.jsxDEV(o.Tr,{children:[e.jsxDEV(o.Th,{children:"Aksi"},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:242,columnNumber:23},void 0),e.jsxDEV(o.Th,{children:"Nama Barang"},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:243,columnNumber:23},void 0),e.jsxDEV(o.Th,{children:"QTY"},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:244,columnNumber:23},void 0),e.jsxDEV(o.Th,{children:"Harga"},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:245,columnNumber:23},void 0)]},void 0,!0,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:241,columnNumber:21},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:240,columnNumber:19},void 0),e.jsxDEV(o.Tbody,{children:(p=(u=i.getValues())==null?void 0:u.items)==null?void 0:p.map((r,t)=>e.jsxDEV(o.Tr,{children:[e.jsxDEV(o.Td,{align:"center",w:$(46),children:e.jsxDEV(U,{size:"lg",color:"red",onClick:()=>i.removeListItem("items",t),disabled:i.getValues().items.length===1,children:e.jsxDEV(pe,{size:16},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:258,columnNumber:29},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:252,columnNumber:27},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:251,columnNumber:25},void 0),e.jsxDEV(o.Td,{children:e.jsxDEV(x,{data:S,placeholder:"Pilih nama barang",disabled:M||E,searchable:!0,withAsterisk:!0,filter:I,...i.getInputProps(`items.${t}.id`)},i.key(`items.${t}.id`),!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:262,columnNumber:27},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:261,columnNumber:25},void 0),e.jsxDEV(o.Td,{children:e.jsxDEV(j,{placeholder:"Masukkan jumlah barang",withAsterisk:!0,hideControls:!0,allowNegative:!1,decimalSeparator:",",thousandSeparator:".",...i.getInputProps(`items.${t}.quantity`)},i.key(`items.${t}.quantity`),!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:274,columnNumber:27},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:273,columnNumber:25},void 0),e.jsxDEV(o.Td,{children:e.jsxDEV(j,{placeholder:"Masukkan harga barang",withAsterisk:!0,decimalSeparator:",",thousandSeparator:".",prefix:"Rp ",allowNegative:!1,hideControls:!0,...i.getInputProps(`items.${t}.price`)},i.key(`items.${t}.price`),!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:286,columnNumber:27},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:285,columnNumber:25},void 0)]},t,!0,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:250,columnNumber:23},void 0))},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:248,columnNumber:19},void 0),e.jsxDEV(o.Tfoot,{children:e.jsxDEV(o.Tr,{children:e.jsxDEV(o.Th,{colSpan:4,children:e.jsxDEV(le,{w:"100%",children:e.jsxDEV(b,{variant:"outline",onClick:()=>i.insertListItem("items",{id:-1,quantity:"",price:""}),leftSection:e.jsxDEV(fe,{size:16},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:314,columnNumber:42},void 0),children:"Tambah Barang"},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:305,columnNumber:27},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:304,columnNumber:25},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:303,columnNumber:23},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:302,columnNumber:21},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:301,columnNumber:19},void 0)]},void 0,!0,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:239,columnNumber:17},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:238,columnNumber:15},void 0)]},void 0,!0,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:235,columnNumber:13},void 0)]},void 0,!0,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:149,columnNumber:11},void 0)]},void 0,!0,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:140,columnNumber:9},void 0)},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:139,columnNumber:7},void 0)]},void 0,!0,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:128,columnNumber:5},void 0)};be.layout=s=>e.jsxDEV(O,{children:s},void 0,!1,{fileName:"D:/Projects/Berlian Motor/berlian-motor-inertia/inertia/pages/goodsReceipts/CreateGoodsReceiptPage.tsx",lineNumber:332,columnNumber:60},void 0);export{be as default};
